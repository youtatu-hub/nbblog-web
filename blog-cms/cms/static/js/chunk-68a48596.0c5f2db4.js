(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68a48596"],{"3e6c":function(e,t,a){"use strict";a("5087")},4020:function(e,t,a){"use strict";var n=a("bc3a"),r=a.n(n),o=a("323e"),s=a.n(o),i=(a("a5d8"),a("5c96"));const l=r.a.create({baseURL:"/api/admin/",timeout:5e3});let u=r.a.CancelToken;l.interceptors.request.use(e=>{const t=window.localStorage.getItem("user")||"{}",a=JSON.parse(t);if("{}"!==t&&"ROLE_admin"!==a.role&&"get"!==e.method)return e.cancelToken=new u((function(e){e("演示模式，不允许操作")})),e;s.a.start();const n=window.localStorage.getItem("token");return n&&(e.headers.Authorization=n),e},e=>(console.info(e),Promise.reject(e))),l.interceptors.response.use(e=>{s.a.done();const t=e.data;if(200!==t.code){let e=t.msg||"Error";return i["Message"].error(e),Promise.reject(new Error(e))}return t},e=>(console.info(e),i["Message"].error(e.message),Promise.reject(e))),t["a"]=l},5087:function(e,t,a){},"89c5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:""}},[a("el-form-item",{attrs:{label:"访客标识"}},[a("el-input",{staticStyle:{"min-width":"300px"},attrs:{clearable:!0,size:"small",placeholder:"请输入访客标识码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.queryInfo.uuid,callback:function(t){e.$set(e.queryInfo,"uuid",t)},expression:"queryInfo.uuid"}})],1),a("el-form-item",{attrs:{label:"访问时间"}},[a("DateTimeRangePicker",{attrs:{date:e.queryInfo.date,setDate:e.setDate}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1)],1),a("el-table",{attrs:{data:e.logList}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"访客标识"}},[a("span",[e._v(e._s(t.row.uuid))])]),a("el-form-item",{attrs:{label:"请求方式"}},[a("span",[e._v(e._s(t.row.method))])]),a("el-form-item",{attrs:{label:"请求接口"}},[a("span",[e._v(e._s(t.row.uri))])]),a("el-form-item",{attrs:{label:"请求参数"}},[a("span",[e._v(e._s(t.row.param))])]),a("el-form-item",{attrs:{label:"备注"}},[a("span",[e._v(e._s(t.row.remark))])])],1)]}}])}),a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"访客标识",width:"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary",href:"",underline:!1},on:{click:function(a){return a.preventDefault(),e.showThis(t.row.uuid)}}},[e._v(e._s(t.row.uuid))])]}}])}),a("el-table-column",{attrs:{label:"访问行为",prop:"behavior"}}),a("el-table-column",{attrs:{label:"访问内容",prop:"content","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"IP",prop:"ip"}}),a("el-table-column",{attrs:{label:"IP来源",prop:"ipSource","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作系统",prop:"os","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"浏览器",prop:"browser","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"访问时间",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("dateFormat")(t.row.createTime)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{title:"确定删除吗？",icon:"el-icon-delete",iconColor:"red"},on:{onConfirm:function(a){return e.deleteLogById(t.row.id)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.queryInfo.pageNum,"page-sizes":[10,20,30,50],"page-size":e.queryInfo.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},r=[],o=a("6350"),s=a("4020");function i(e){return Object(s["a"])({url:"visitLogs",method:"GET",params:{...e}})}function l(e){return Object(s["a"])({url:"visitLog",method:"DELETE",params:{id:e}})}var u=a("eb7a"),c={name:"VisitLog",components:{DateTimeRangePicker:u["a"],Breadcrumb:o["a"]},data(){return{queryInfo:{uuid:"",date:[],pageNum:1,pageSize:10},logList:[],total:0}},created(){this.$route.query.uuid&&(this.queryInfo.uuid=this.$route.query.uuid),this.getData()},methods:{getData(){let e={...this.queryInfo};e.date&&2===e.date.length&&(e.date=e.date[0]+","+e.date[1]),i(e).then(e=>{this.logList=e.data.list,this.total=e.data.total})},handleSizeChange(e){this.queryInfo.pageSize=e,this.getData()},handleCurrentChange(e){this.queryInfo.pageNum=e,this.getData()},deleteLogById(e){l(e).then(e=>{this.msgSuccess(e.msg),this.getData()})},search(){this.queryInfo.pageNum=1,this.queryInfo.pageSize=10,this.getData()},showThis(e){this.queryInfo.uuid=e,this.search()},setDate(e){this.queryInfo.date=e}}},d=c,p=(a("3e6c"),a("2877")),m=Object(p["a"])(d,n,r,!1,null,"1ef31172",null);t["default"]=m.exports},eb7a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-date-picker",{attrs:{type:"datetimerange",align:"center",size:"small","unlink-panels":"","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"start-placeholder":"开始时间","end-placeholder":"结束时间","range-separator":"-"},on:{change:function(t){return e.setDate(e.thisDate)}},model:{value:e.thisDate,callback:function(t){e.thisDate=t},expression:"thisDate"}})},r=[],o={name:"DateTimeRangePicker",props:{date:{required:!0},setDate:{type:Function,required:!0}},data(){return{thisDate:this.date,pickerOptions:{shortcuts:[{text:"今天",onClick(e){const t=new Date,a=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),a.setHours(23),a.setMinutes(59),a.setSeconds(59),e.$emit("pick",[t,a])}},{text:"昨天",onClick(e){const t=new Date,a=new Date,n=new Date;a.setTime(t.getTime()-864e5),n.setTime(t.getTime()-864e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),n.setHours(23),n.setMinutes(59),n.setSeconds(59),e.$emit("pick",[a,n])}},{text:"最近三天",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e5),e.$emit("pick",[a,t])}},{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]}}}},s=o,i=a("2877"),l=Object(i["a"])(s,n,r,!1,null,"7be8d8c8",null);t["a"]=l.exports}}]);