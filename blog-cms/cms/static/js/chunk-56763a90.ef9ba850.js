(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56763a90"],{"00ee":function(t,e,r){var o=r("b622"),a=o("toStringTag"),i={};i[a]="z",t.exports="[object z]"===String(i)},"0366":function(t,e,r){var o=r("1c0b");t.exports=function(t,e,r){if(o(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,o){return t.call(e,r,o)};case 3:return function(r,o,a){return t.call(e,r,o,a)}}return function(){return t.apply(e,arguments)}}},2266:function(t,e,r){var o=r("825a"),a=r("e95a"),i=r("50c4"),n=r("0366"),s=r("35a1"),l=r("9bdd"),c=function(t,e){this.stopped=t,this.result=e},u=t.exports=function(t,e,r,u,m){var f,d,p,b,g,h,v,w=n(e,r,u?2:1);if(m)f=t;else{if(d=s(t),"function"!=typeof d)throw TypeError("Target is not iterable");if(a(d)){for(p=0,b=i(t.length);b>p;p++)if(g=u?w(o(v=t[p])[0],v[1]):w(t[p]),g&&g instanceof c)return g;return new c(!1)}f=d.call(t)}h=f.next;while(!(v=h.call(f)).done)if(g=l(f,w,v.value,u),"object"==typeof g&&g&&g instanceof c)return g;return new c(!1)};u.stop=function(t){return new c(!0,t)}},"35a1":function(t,e,r){var o=r("f5dfe"),a=r("3f8c"),i=r("b622"),n=i("iterator");t.exports=function(t){if(void 0!=t)return t[n]||t["@@iterator"]||a[o(t)]}},"3f8c":function(t,e){t.exports={}},4020:function(t,e,r){"use strict";var o=r("bc3a"),a=r.n(o),i=r("323e"),n=r.n(i),s=(r("a5d8"),r("5c96"));const l=a.a.create({baseURL:"/api/admin/",timeout:5e3});let c=a.a.CancelToken;l.interceptors.request.use(t=>{const e=window.localStorage.getItem("user")||"{}",r=JSON.parse(e);if("{}"!==e&&"ROLE_admin"!==r.role&&"get"!==t.method)return t.cancelToken=new c((function(t){t("演示模式，不允许操作")})),t;n.a.start();const o=window.localStorage.getItem("token");return o&&(t.headers.Authorization=o),t},t=>(console.info(t),Promise.reject(t))),l.interceptors.response.use(t=>{n.a.done();const e=t.data;if(200!==e.code){let t=e.msg||"Error";return s["Message"].error(t),Promise.reject(new Error(t))}return e},t=>(console.info(t),s["Message"].error(t.message),Promise.reject(t))),e["a"]=l},"4e3e":function(t,e,r){"use strict";var o=r("23e7"),a=r("2266"),i=r("825a");o({target:"Iterator",proto:!0,real:!0},{forEach:function(t){a(i(this),t,void 0,!1,!0)}})},"864d":function(t,e,r){"use strict";r.d(e,"d",(function(){return a})),r.d(e,"a",(function(){return i})),r.d(e,"c",(function(){return n})),r.d(e,"e",(function(){return s})),r.d(e,"h",(function(){return l})),r.d(e,"g",(function(){return c})),r.d(e,"i",(function(){return u})),r.d(e,"b",(function(){return m})),r.d(e,"f",(function(){return f}));var o=r("4020");function a(t){return Object(o["a"])({url:"blogs",method:"GET",params:{...t}})}function i(t){return Object(o["a"])({url:"blog",method:"DELETE",params:{id:t}})}function n(){return Object(o["a"])({url:"categoryAndTag",method:"GET"})}function s(t){return Object(o["a"])({url:"blog",method:"POST",data:{...t}})}function l(t,e){return Object(o["a"])({url:"blog/top",method:"PUT",params:{id:t,top:e}})}function c(t,e){return Object(o["a"])({url:"blog/recommend",method:"PUT",params:{id:t,recommend:e}})}function u(t,e){return Object(o["a"])({url:`blog/${t}/visibility`,method:"PUT",data:{...e}})}function m(t){return Object(o["a"])({url:"blog",method:"GET",params:{id:t}})}function f(t){return Object(o["a"])({url:"blog",method:"PUT",data:{...t}})}},"956d":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{ref:"formRef",attrs:{model:t.form,rules:t.formRules,"label-position":"top"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文章首图URL",prop:"firstPicture"}},[r("el-input",{attrs:{placeholder:"文章首图，用于随机文章展示"},model:{value:t.form.firstPicture,callback:function(e){t.$set(t.form,"firstPicture",e)},expression:"form.firstPicture"}})],1)],1)],1),r("el-form-item",{attrs:{label:"文章描述",prop:"description"}},[r("mavon-editor",{model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),r("el-form-item",{attrs:{label:"文章正文",prop:"content"}},[r("mavon-editor",{model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"分类",prop:"cate"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分类（输入可添加新分类）","allow-create":!0,filterable:!0},model:{value:t.form.cate,callback:function(e){t.$set(t.form,"cate",e)},expression:"form.cate"}},t._l(t.categoryList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"标签",prop:"tagList"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择标签（输入可添加新标签）","allow-create":!0,filterable:!0,multiple:!0},model:{value:t.form.tagList,callback:function(e){t.$set(t.form,"tagList",e)},expression:"form.tagList"}},t._l(t.tagList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"字数",prop:"words"}},[r("el-input",{attrs:{placeholder:"请输入文章字数（自动计算阅读时长）",type:"number"},model:{value:t.form.words,callback:function(e){t.$set(t.form,"words",e)},expression:"form.words"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"阅读时长(分钟)",prop:"readTime"}},[r("el-input",{attrs:{placeholder:"请输入阅读时长（可选）默认 Math.round(字数 / 200)",type:"number"},model:{value:t.form.readTime,callback:function(e){t.$set(t.form,"readTime",e)},expression:"form.readTime"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"浏览次数",prop:"views"}},[r("el-input",{attrs:{placeholder:"请输入文章字数（可选）默认为 0",type:"number"},model:{value:t.form.views,callback:function(e){t.$set(t.form,"views",e)},expression:"form.views"}})],1)],1)],1),r("el-form-item",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("保存")])],1)],1),r("el-dialog",{attrs:{title:"博客可见性",width:"30%",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-form",{attrs:{"label-width":"50px"},nativeOn:{submit:function(t){t.preventDefault()}}},[r("el-form-item",[r("el-radio-group",{model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[r("el-radio",{attrs:{label:1}},[t._v("公开")]),r("el-radio",{attrs:{label:2}},[t._v("私密")]),r("el-radio",{attrs:{label:3}},[t._v("密码保护")])],1)],1),3===t.radio?r("el-form-item",{attrs:{label:"密码"}},[r("el-input",{model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1):t._e(),2!==t.radio?r("el-form-item",[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-switch",{attrs:{"active-text":"赞赏"},model:{value:t.form.appreciation,callback:function(e){t.$set(t.form,"appreciation",e)},expression:"form.appreciation"}})],1),r("el-col",{attrs:{span:6}},[r("el-switch",{attrs:{"active-text":"推荐"},model:{value:t.form.recommend,callback:function(e){t.$set(t.form,"recommend",e)},expression:"form.recommend"}})],1),r("el-col",{attrs:{span:6}},[r("el-switch",{attrs:{"active-text":"评论"},model:{value:t.form.commentEnabled,callback:function(e){t.$set(t.form,"commentEnabled",e)},expression:"form.commentEnabled"}})],1),r("el-col",{attrs:{span:6}},[r("el-switch",{attrs:{"active-text":"置顶"},model:{value:t.form.top,callback:function(e){t.$set(t.form,"top",e)},expression:"form.top"}})],1)],1)],1):t._e()],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")])],1)],1)],1)},a=[],i=(r("0643"),r("4e3e"),r("6350")),n=r("864d"),s={name:"WriteBlog",components:{Breadcrumb:i["a"]},data(){return{categoryList:[],tagList:[],dialogVisible:!1,radio:1,form:{title:"",firstPicture:"",description:"",content:"",cate:null,tagList:[],words:null,readTime:null,views:0,appreciation:!1,recommend:!1,commentEnabled:!1,top:!1,published:!1,password:""},formRules:{title:[{required:!0,message:"请输入标题",trigger:"change"}],firstPicture:[{required:!0,message:"请输入首图链接",trigger:"change"}],cate:[{required:!0,message:"请选择分类",trigger:"change"}],tagList:[{required:!0,message:"请选择标签",trigger:"change"}],words:[{required:!0,message:"请输入文章字数",trigger:"change"}]}}},watch:{"form.words"(t){this.form.readTime=t?Math.round(t/200):null}},created(){this.getData(),this.$route.params.id&&this.getBlog(this.$route.params.id)},methods:{getData(){Object(n["c"])().then(t=>{this.categoryList=t.data.categories,this.tagList=t.data.tags})},getBlog(t){Object(n["b"])(t).then(t=>{this.computeCategoryAndTag(t.data),this.form=t.data,this.radio=this.form.published?""!==this.form.password?3:1:2})},computeCategoryAndTag(t){t.cate=t.category.id,t.tagList=[],t.tags.forEach(e=>{t.tagList.push(e.id)})},submit(){if(3===this.radio&&(""===this.form.password||null===this.form.password))return this.msgError("密码保护模式必须填写密码！");this.$refs.formRef.validate(t=>{if(!t)return this.dialogVisible=!1,this.msgError("请填写必要的表单项");2===this.radio?(this.form.appreciation=!1,this.form.recommend=!1,this.form.commentEnabled=!1,this.form.top=!1,this.form.published=!1):this.form.published=!0,3!==this.radio&&(this.form.password=""),this.$route.params.id?(this.form.category=null,this.form.tags=null,Object(n["f"])(this.form).then(t=>{this.msgSuccess(t.msg),this.$router.push("/blog/list")})):Object(n["e"])(this.form).then(t=>{this.msgSuccess(t.msg),this.$router.push("/blog/list")})})}}},l=s,c=r("2877"),u=Object(c["a"])(l,o,a,!1,null,"55da4a1a",null);e["default"]=u.exports},e95a:function(t,e,r){var o=r("b622"),a=r("3f8c"),i=o("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(a.Array===t||n[i]===t)}},f5dfe:function(t,e,r){var o=r("00ee"),a=r("c6b6"),i=r("b622"),n=i("toStringTag"),s="Arguments"==a(function(){return arguments}()),l=function(t,e){try{return t[e]}catch(r){}};t.exports=o?a:function(t){var e,r,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=l(e=Object(t),n))?r:s?a(e):"Object"==(o=a(e))&&"function"==typeof e.callee?"Arguments":o}}}]);