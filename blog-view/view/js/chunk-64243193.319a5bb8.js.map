{"version":3,"sources":["webpack:///./src/views/moments/Moments.vue?d12a","webpack:///./src/views/moments/Moments.vue?ab64","webpack:///./src/api/moment.js","webpack:///src/views/moments/Moments.vue","webpack:///./src/views/moments/Moments.vue?3b5f","webpack:///./src/views/moments/Moments.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_m","staticClass","_l","moment","index","key","attrs","$store","state","introduction","avatar","staticStyle","_v","_s","name","_f","createTime","directives","rawName","value","selector","expression","class","published","domProps","content","on","$event","like","id","isLike","likes","pageNum","totalPage","handleCurrentChange","staticRenderFns","getMomentListByPageNum","token","axios","url","method","headers","Authorization","params","likeMoment","data","likeMomentIds","JSON","parse","window","localStorage","getItem","momentList","created","getMomentList","computed","indexOf","watch","newValue","setItem","stringify","methods","adminToken","then","res","code","list","msgError","msg","catch","newPage","scrollToTop","$notify","title","type","push","forEach","item","component"],"mappings":"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","file":"js/chunk-64243193.319a5bb8.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Moments.vue?vue&type=style&index=0&id=42efd05e&prod&scoped=true&lang=css\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._m(0),_c('div',{staticClass:\"ui attached segment m-padding-bottom-large\"},[_c('div',{staticClass:\"moments\"},_vm._l((_vm.momentList),function(moment,index){return _c('div',{key:index,staticClass:\"moment\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm.$store.state.introduction.avatar}})]),_c('div',{staticClass:\"ui card\"},[_c('div',{staticClass:\"content m-top\"},[_c('span',{staticStyle:{\"font-weight\":\"700\"}},[_vm._v(_vm._s(_vm.$store.state.introduction.name))]),_c('span',{staticClass:\"right floated\"},[_vm._v(_vm._s(_vm._f(\"dateFromNow\")(moment.createTime)))])]),_c('div',{directives:[{name:\"lazy-container\",rawName:\"v-lazy-container\",value:({selector: 'img'}),expression:\"{selector: 'img'}\"},{name:\"viewer\",rawName:\"v-viewer\"}],staticClass:\"content typo\",class:{'privacy':!moment.published},domProps:{\"innerHTML\":_vm._s(moment.content)}}),_c('div',{staticClass:\"extra content\"},[_c('a',{staticClass:\"left floated\",on:{\"click\":function($event){return _vm.like(moment.id)}}},[_c('i',{staticClass:\"heart icon\",class:_vm.isLike(moment.id)?'like-color':'outline'}),_vm._v(_vm._s(moment.likes)+\" \")])])])])}),0),_c('el-pagination',{staticClass:\"pagination\",attrs:{\"current-page\":_vm.pageNum,\"page-count\":_vm.totalPage,\"layout\":\"prev, pager, next\",\"background\":\"\",\"hide-on-single-page\":\"\"},on:{\"current-change\":_vm.handleCurrentChange}})],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ui top attached segment\",staticStyle:{\"text-align\":\"center\"}},[_c('h2',{staticClass:\"m-text-500\"},[_vm._v(\"我的动态\")])])}]\n\nexport { render, staticRenderFns }","import axios from '@/plugins/axios'\n\nexport function getMomentListByPageNum(token, pageNum) {\n\treturn axios({\n\t\turl: 'moments',\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAuthorization: token,\n\t\t},\n\t\tparams: {\n\t\t\tpageNum\n\t\t}\n\t})\n}\n\nexport function likeMoment(id) {\n\treturn axios({\n\t\turl: `moment/like/${id}`,\n\t\tmethod: 'POST',\n\t})\n}","<template>\n\t<div>\n\t\t<div class=\"ui top attached segment\" style=\"text-align: center\">\n\t\t\t<h2 class=\"m-text-500\">我的动态</h2>\n\t\t</div>\n\t\t<div class=\"ui attached segment m-padding-bottom-large\">\n\t\t\t<div class=\"moments\">\n\t\t\t\t<div class=\"moment\" v-for=\"(moment,index) in momentList\" :key=\"index\">\n\t\t\t\t\t<div class=\"avatar\">\n\t\t\t\t\t\t<img :src=\"$store.state.introduction.avatar\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui card\">\n\t\t\t\t\t\t<div class=\"content m-top\">\n\t\t\t\t\t\t\t<span style=\"font-weight: 700\">{{ $store.state.introduction.name }}</span>\n\t\t\t\t\t\t\t<span class=\"right floated\">{{ moment.createTime | dateFromNow }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content typo\" :class=\"{'privacy':!moment.published}\" v-lazy-container=\"{selector: 'img'}\" v-viewer v-html=\"moment.content\"></div>\n\t\t\t\t\t\t<div class=\"extra content\">\n\t\t\t\t\t\t\t<a class=\"left floated\" @click=\"like(moment.id)\">\n\t\t\t\t\t\t\t\t<i class=\"heart icon\" :class=\"isLike(moment.id)?'like-color':'outline'\"></i>{{ moment.likes }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<el-pagination @current-change=\"handleCurrentChange\" :current-page=\"pageNum\" :page-count=\"totalPage\"\n\t\t\t               layout=\"prev, pager, next\" background hide-on-single-page class=\"pagination\">\n\t\t\t</el-pagination>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport {getMomentListByPageNum, likeMoment} from \"@/api/moment\";\n\n\texport default {\n\t\tname: \"Moments\",\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t//用localStorage本地存储已点赞的动态id数组\n\t\t\t\tlikeMomentIds: JSON.parse(window.localStorage.getItem('likeMomentIds') || '[]'),\n\t\t\t\tmomentList: [],\n\t\t\t\tpageNum: 1,\n\t\t\t\ttotalPage: 0\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis.getMomentList()\n\t\t},\n\t\tcomputed: {\n\t\t\tisLike() {\n\t\t\t\treturn function (id) {\n\t\t\t\t\treturn this.likeMomentIds.indexOf(id) > -1\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\tlikeMomentIds(newValue) {\n\t\t\t\t//将likeMomentIds最新值的json数据保存到localStorage\n\t\t\t\twindow.localStorage.setItem('likeMomentIds', JSON.stringify(newValue))\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tgetMomentList() {\n\t\t\t\t//如果有则发送博主身份Token\n\t\t\t\tconst adminToken = window.localStorage.getItem('adminToken')\n\t\t\t\tconst token = adminToken ? adminToken : ''\n\t\t\t\tgetMomentListByPageNum(token, this.pageNum).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.momentList = res.data.list\n\t\t\t\t\t\tthis.totalPage = res.data.totalPage\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.msgError(\"请求失败\")\n\t\t\t\t})\n\t\t\t},\n\t\t\thandleCurrentChange(newPage) {\n\t\t\t\tthis.scrollToTop()\n\t\t\t\tthis.pageNum = newPage\n\t\t\t\tthis.getMomentList()\n\t\t\t},\n\t\t\tlike(id) {\n\t\t\t\tif (this.likeMomentIds.indexOf(id) > -1) {\n\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\ttitle: '不可以重复点赞哦',\n\t\t\t\t\t\ttype: 'warning'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tlikeMoment(id).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\t\ttitle: res.msg,\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.likeMomentIds.push(id)\n\t\t\t\t\t\tthis.momentList.forEach(item => {\n\t\t\t\t\t\t\tif (item.id === id) {\n\t\t\t\t\t\t\t\treturn item.likes++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\t\ttitle: res.msg,\n\t\t\t\t\t\t\ttype: 'warning'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\ttitle: '异常错误',\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.avatar {\n\t\tmargin-left: -62.5px;\n\t\tfloat: left !important;\n\t}\n\n\t.avatar img {\n\t\theight: 45px;\n\t\twidth: 45px;\n\t\tborder-radius: 500px;\n\t}\n\n\t.moments {\n\t\tmargin-left: 26px !important;\n\t\tpadding-left: 40px !important;\n\t\tborder-left: 1px solid #dee5e7 !important;\n\t}\n\n\t.moment {\n\t\tmargin-top: 30px;\n\t}\n\n\t.moment:first-child {\n\t\tmargin-top: 0 !important;\n\t}\n\n\t.card {\n\t\twidth: 100% !important;\n\t}\n\n\t.card:before {\n\t\tborder-width: 0 0 1px 1px !important;\n\t\ttransform: translateX(-50%) translateY(-50%) rotate(45deg) !important;\n\t\tbottom: auto !important;\n\t\tright: auto !important;\n\t\ttop: 22px !important;\n\t\tleft: 0 !important;\n\t\tposition: absolute !important;\n\t\tcontent: '' !important;\n\t\tbackground-image: none !important;\n\t\tz-index: 2 !important;\n\t\twidth: 12px !important;\n\t\theight: 12px !important;\n\t\ttransition: background .1s ease !important;\n\t\tbackground-color: inherit !important;\n\t\tborder-style: solid !important;\n\t\tborder-color: #d4d4d5 !important;\n\t}\n\n\t.content.m-top {\n\t\tpadding: 10px 14px !important;\n\t}\n\n\t.content .right.floated {\n\t\tfont-size: 12px !important;\n\t}\n\n\t.content.typo * {\n\t\tfont-size: 14px !important;\n\t}\n\n\t.extra.content {\n\t\tpadding: 5px 14px !important;\n\t}\n\n\t.extra.content a {\n\t\tcolor: rgba(0, 0, 0, 0.7) !important;\n\t\tfont-size: 12px !important;\n\t}\n\n\t.extra.content a:hover {\n\t\tcolor: red !important;\n\t}\n\n\t.extra.content .like-color {\n\t\tcolor: red !important;\n\t}\n\n\t.extra.content i {\n\t\tfont-size: 12px !important;\n\t}\n\n\t.pagination {\n\t\ttext-align: center;\n\t\tmargin-top: 3em;\n\t}\n\n\t.privacy {\n\t\tbackground: repeating-linear-gradient(145deg, #f2f2f2, #f2f2f2 15px, #fff 0, #fff 30px) !important;\n\t}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Moments.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Moments.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Moments.vue?vue&type=template&id=42efd05e&scoped=true\"\nimport script from \"./Moments.vue?vue&type=script&lang=js\"\nexport * from \"./Moments.vue?vue&type=script&lang=js\"\nimport style0 from \"./Moments.vue?vue&type=style&index=0&id=42efd05e&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"42efd05e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}